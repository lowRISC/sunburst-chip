diff --git a/gen.py b/gen.py
index 4183e52..72a25ce 100644
--- a/gen.py
+++ b/gen.py
@@ -13,10 +13,10 @@
 from make_new_dif.ip import Ip
 from mako.template import Template
 
+# This file is $REPO_TOP/hw/vendor/lowrisc_ip/util/autogen_testutils/gen.py, so it takes six parent()
-# This file is $REPO_TOP/util/autogen_testutils.py, so it takes two parent()
 # calls to get back to the top.
+IP_TOP = Path(__file__).resolve().parent.parent.parent
+REPO_TOP = IP_TOP.parent.parent.parent
-REPO_TOP = Path(__file__).resolve().parent.parent.parent
-
 
 def gen_testutils(ips_with_difs: List[Ip]) -> None:
     """Generate testutils libraries that are rendered from Mako templates.
@@ -31,7 +31,7 @@
     ips_with_difs.sort(key=lambda ip: ip.name_snake)
 
     # Define input/output directories.
+    testutils_templates_dir = IP_TOP / "util/autogen_testutils/templates"
-    testutils_templates_dir = REPO_TOP / "util/autogen_testutils/templates"
     autogen_testutils_dir = REPO_TOP / "sw/device/lib/testing/autogen"
 
     # Create output directories if needed.
@@ -57,7 +57,7 @@
     # Format autogenerated file with clang-format.
     try:
         subprocess.check_call(
+            ["clang-format", "-i", "--"] + testutilses
-            ["./bazelisk.sh", "run", "//quality:clang_format_fix", "--"] + testutilses
         )
     except subprocess.CalledProcessError:
         logging.error(
